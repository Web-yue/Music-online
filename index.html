<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<div id="elDiv">
    <h1>测试数据</h1>
</div>
<script type="text/javascript">

    var tankuang=function () {
        alert(33)
    }

    function printDiv(div_print) {
        alert(22)
        var headstr = "<html><head><title></title></head><body><OBJECT classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' height='0' id='wb2' name='wb2' width='0'></OBJECT>";

        var footstr = "</body>";
        var newstr = document.getElementById(div_print).innerHTML;
        var oldstr = document.body.innerHTML;
        document.body.innerHTML = headstr+newstr+footstr;
        //document.write(headstr+newstr+footstr);
        //PageSetup("footer","");
        //PageSetup("header","");
        //PageSetup("margin_top","0");
        //PageSetup("margin_right","0");
        //PageSetup("margin_bottom","0");
        //PageSetup("margin_left","0");
        //wb2.ExecWB(7,1);
        document.all.wb2.ExecWB(7,1);
        document.close();
        //window.print();
        document.body.innerHTML = oldstr;
        return true;
    }

    document.getElementById('btn').onclick=function () {
        printDiv('elDiv')
    }
</script>


<button id="btn" onclick="printDiv('elDiv');">打印</button>
<button id="btn" onclick="tankuang;">ceshi打印</button>
<!--<a href="javascript:void(0)" onclick="document.all.wb2.Execwb(6,1)">打1印</a>-->
</body>


</html>
