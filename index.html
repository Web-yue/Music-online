<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<div id="elTableOut">
    <h1>测试数据</h1>
</div>
    <button id="btn" onclick="printDiv('elDiv');">打印</button>
<button id="btn2" >ceshi打印</button>
<script type="text/javascript">

    var tankuang=function () {alert(3);
         var el = document.getElementById('elTableOut');
                var iframe = document.createElement('IFRAME');
                var doc = null;
                iframe.setAttribute('style', 'position:absolute;width:0px;height:0px;left:-500px;top:-500px;');
                document.body.appendChild(iframe);
                var headstr = "<html><head><title></title></head><body><OBJECT classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' height='0' id='wb2' name='wb2' width='0'></OBJECT>";
                var footstr = "</body>";
                var newstr = document.getElementById(div_print).innerHTML;
                var oldstr = document.body.innerHTML;
                doc = iframe.contentWindow.document;
                // 引入打印的专有CSS样式，www.111Cn.net根据实际修改
                // doc.write("<LINK rel="stylesheet" type="text/css" href="css/print.css">");
                doc.write(headstr+newstr+footstr);
                doc.close();
                iframe.contentWindow.focus();
                wb2.ExecWB(7,1);
                // iframe.contentWindow.print();
                if (navigator.userAgent.indexOf("MSIE") > 0)
                {
                    document.body.removeChild(iframe);
                }
    }

    function printDiv(div_print) {
        alert(22)
        var headstr = "<html><head><title></title></head><body><OBJECT classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' height='0' id='wb2' name='wb2' width='0'></OBJECT>";

        var footstr = "</body>";
        var newstr = document.getElementById(div_print).innerHTML;
        var oldstr = document.body.innerHTML;
        document.body.innerHTML = headstr+newstr+footstr;
        //document.write(headstr+newstr+footstr);
        //PageSetup("footer","");
        //PageSetup("header","");
        //PageSetup("margin_top","0");
        //PageSetup("margin_right","0");
        //PageSetup("margin_bottom","0");
        //PageSetup("margin_left","0");
         wb2.ExecWB(7,1);
        
        document.close();
        //window.print();
        document.body.innerHTML = oldstr;
        return true;
    }

    document.getElementById('btn').onclick=function () {
        printDiv('elTableOut')
    }
    
     document.getElementById('btn2').onclick=function () {
        tankuang()
    }
</script>



<!--<a href="javascript:void(0)" onclick="document.all.wb2.Execwb(6,1)">打1印</a>-->
</body>


</html>
